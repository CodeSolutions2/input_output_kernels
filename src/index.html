<!DOCTYPE html>
<html>
<head></head>
<body>


<button id="run_selection" onclick="run_selection()" style="display:block;">Run Selection</button>

<div id="output">

<div id="data_display" style="display:block;text-align:left;width:600px;"></div>

<canvas id="canvasElement_id" width="10" height="10" style="display:block;"></canvas>

<style>
canvas {border: 0px solid black; position: absolute; display: inline-block; z-index: 0; top: 100px}
</style>


<script>

var width = canvasElement.width;
var height = canvasElement.height;



async function run_selection() {


  // Create a 2darray.
  var n = width;
  var arr2d = await Array.from({length: n}, (row,irow) => { return Array.from({length: n}, (v,i) => { return (irow == i) ? 1 : 0; }); });
  await document.getElementById("output").innerHTML += "arr2d: "+arr2d+"<br>";
 

  var ctx = document.getElementById("canvasElement_id").getContext("2d");
  ctx.fillStyle = "rgb(153 153 153 / 100%)";
  ctx.fillRect(0, 0, width, height);
  

  // Obtain a TypedArray from the canvas.
  const TypedArray = await ctx.getImageData(0, 0, width, height);
  document.getElementById("output").innerHTML += "TypedArray: "+TypedArray+"<br>";


  // Add border to output display.
  document.getElementById("canvasElement_id").style.border = "1px solid black";


  // Put the array on the canvas.
  const imageData = await new ImageData(TypedArray, width, height);
  document.getElementById("output").innerHTML += "imageData: "+imageData+"<br>";

}



</script>
</body>
</html>
