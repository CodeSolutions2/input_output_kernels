<!DOCTYPE html>
<html>
<head></head>
<body>

<button id="run_selection" onclick="run_selection()">Run Selection</button>

<div id="output">

<script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@latest"></script>

<script>


async function run_selection() {

  const epochs = 50;
  const batchSize = 32;
  const lr = 0.001;


  var xs = [];
  var ys = [];
  const rows = 100;
  const cols = 10;
  for (var i=0; i<rows; i++) {
    if (i%2 == 0) {
      var data0 = Array.from({length: cols}, (x) => Math.random());
      xs.push(data0);
      ys.push(0);
    } else {
      var data1 = Array.from({length: cols}, (x) => 10*Math.random());
      xs.push(data1);
      ys.push(1);
    }
  }

  xs = tf.tensor(xs, [rows, cols]);
  ys = tf.oneHot(tf.tensor1d(ys, 'int32'), 2);
  

  // Create the model
  const input = tf.input({shape: [cols]});
  const dense0 = tf.layers.dense({units: 32, activation: 'relu'});
  const dense1 = tf.layers.dense({units: 2, activation: 'softmax'});
  const output = dense1.apply(dense0.apply(input));
  const model = tf.model({inputs: input, outputs: output});
  document.getElementById("output").innerHTML += "model: "+model+"<br>";

  model.compile({
    optimizer: 'sgd',
    loss: 'categoricalCrossentropy',
    metrics: ['accuracy']
  });

model.fit(xs, ys, {
   epochs: epochs,
   batchSize: batchSize,
   callbacks: {onBatchEnd}
 }).then(info => {
   document.getElementById("output").innerHTML += "info.history.acc: "+info.history.acc+"<br>";
 });

}


function onBatchEnd(batch, logs) {
  const value = Number(Math.floor(rows/batchSize));
  if (batch%value == 0) {
    document.getElementById("output").innerHTML += "batch: "+batch+"<br>";
    document.getElementById("output").innerHTML += "logs.acc: "+logs.acc+"<br>";
  }
}



</script>
</body>
</html>
